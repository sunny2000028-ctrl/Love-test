<!DOCTYPE html><html lang="ru">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1,maximum-scale=1" />
<title>Тест совместимости — для Лены</title>
<style>
  :root{--accent:#e44479;--bg1:#fff5f8;--bg2:#ffe8f1}
  *{box-sizing:border-box}
  body{font-family:Inter, system-ui, -apple-system, "Segoe UI", Roboto, "Helvetica Neue", Arial; margin:0; background:linear-gradient(180deg,var(--bg1),var(--bg2)); color:#222; -webkit-text-size-adjust:100%}
  .wrap{max-width:520px;margin:0 auto;padding:18px}
  header{display:flex;align-items:center;gap:12px}
  h1{margin:0;font-size:22px;color:var(--accent)}
  p.lead{margin:8px 0 18px;color:#555}
  .card{background:rgba(255,255,255,0.85);border-radius:14px;padding:16px;box-shadow:0 6px 20px rgba(0,0,0,0.06)}
  .center{text-align:center}
  button.primary{background:var(--accent);color:#fff;border:none;padding:12px 16px;border-radius:12px;font-size:17px;width:100%;cursor:pointer}
  .question{display:none;padding:8px}
  .answers{display:flex;flex-direction:column;gap:10px;margin-top:12px}
  .answers button{background:#fff;border:2px solid #ffd9e6;padding:12px;border-radius:12px;font-size:16px;color:var(--accent);cursor:pointer}
  .answers button:active{transform:scale(.995)}
  #final-screen{display:none;padding:8px}
  .photos{display:flex;gap:8px;overflow:hidden;border-radius:12px}
  .photos img{width:100%;height:260px;object-fit:cover;border-radius:12px}
  /* animated hearts */
  .heart{position:fixed;pointer-events:none;font-size:18px}
  /* typing */
  .type{font-weight:600;color:var(--accent);font-size:20px}
  /* fireworks canvas */
  canvas#fire{position:fixed;left:0;top:0;pointer-events:none;width:100%;height:100%;z-index:40}
  /* slideshow overlay */
  .slideshow{position:relative;border-radius:12px;overflow:hidden}
  .slide{position:absolute;inset:0;opacity:0;transition:opacity .9s ease}
  .slide.active{opacity:1}
  /* responsive tweaks */
  @media(min-width:600px){.wrap{padding:28px}} 
</style>
</head>
<body>
<canvas id="fire"></canvas>
<div class="wrap">
  <header>
    <h1>Небольшой тест… но с очень важным финалом</h1>
  </header>
  <p class="lead">Этот тест — для Лены. Он мягкий, трогательный и ведёт к одному единственному вопросу. У тебя на телефоне должна быть возможность включить звук — мы сделаем это аккуратно.</p>  <div class="card center" id="start-card">
    <div style="margin-bottom:12px">Прежде чем начать — нажми <strong>«Начать тест»</strong>, чтобы включить музыку и эффекты. Это даст нам разрешение на воспроизведение и вибрацию на телефоне (только когда ты сама начнёшь).</div>
    <button class="primary" id="startBtn">Начать тест</button>
  </div>  <div id="testArea" style="display:none"><div class="card" id="intro-card">
  <div class="slideshow" id="slideshow" style="height:260px;margin-bottom:12px">
    <!-- Place photos named photo1.jpg, photo2.jpg, photo3.jpg in same folder -->
    <div class="slide active"><img src="photo1.jpg" alt="photo1" style="width:100%;height:100%;object-fit:cover"></div>
    <div class="slide"><img src="photo2.jpg" alt="photo2" style="width:100%;height:100%;object-fit:cover"></div>
    <div class="slide"><img src="photo3.jpg" alt="photo3" style="width:100%;height:100%;object-fit:cover"></div>
  </div>
  <div class="center">
    <div class="type" id="typedIntro">Для Лены — маленькое путешествие.</div>
    <p class="lead" style="margin-top:8px">Ответь честно, следуй за сердцем. В конце тебя ждёт сюрприз.</p>
  </div>
</div>

<div id="questions" style="margin-top:14px">
  <!-- Questions will be injected by JS -->
</div>

<div id="final-screen" class="card center">
  <div id="finalIntro" style="font-size:18px;color:#333;margin-bottom:10px"></div>
  <div id="finalPhotos" style="margin-bottom:12px"></div>
  <p style="font-size:18px;color:var(--accent);line-height:1.35">
    <span id="typedFinal"></span>
  </p>
  <div style="margin-top:14px">
    <button class="primary" id="yesBtn">Да</button>
  </div>
</div>

  </div></div><!-- Hidden audio (will start after user gesture) --><audio id="bgmusic" loop preload="auto" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7e6285b8b5.mp3?filename=romantic-ambient-110397.mp3"></audio>

<script>
// ====== Config ======
const QUESTIONS = [
  'Помнишь ли ты тот момент, когда впервые поняла, что я тебе нравлюсь?',
  'Что ты почувствовала в тот момент?',
  'Какое наше воспоминание ты бы пережила ещё раз?',
  'Что делает наши отношения особенными?',
  'Чего тебе не хватает, когда меня нет рядом?',
  'Как ты представляешь наше будущее?',
  'Что для тебя значит быть со мной?',
  'Какое чувство первое приходит, когда видишь меня?',
  'Хочешь ли ты создавать новые воспоминания вместе?',
  'Веришь ли ты в любовь на всю жизнь?',
  'Хочешь ли идти со мной по жизни?',
  'Согласна ли ты на самый важный вопрос в конце теста?'
];
// ====== End config ======

const startBtn = document.getElementById('startBtn');
const testArea = document.getElementById('testArea');
const questionsWrap = document.getElementById('questions');
const bgmusic = document.getElementById('bgmusic');
const finalScreen = document.getElementById('final-screen');
const typedIntro = document.getElementById('typedIntro');
const typedFinal = document.getElementById('typedFinal');
const finalIntro = document.getElementById('finalIntro');
const finalPhotos = document.getElementById('finalPhotos');
const yesBtn = document.getElementById('yesBtn');

// Build question cards
function buildQuestions(){
  QUESTIONS.forEach((q,i)=>{
    const id = 'q'+(i+1);
    const card = document.createElement('div');
    card.className='card question';
    card.id=id;
    const p = document.createElement('p'); p.textContent = (i+1)+'. '+q;
    card.appendChild(p);
    const answers = document.createElement('div'); answers.className='answers';
    const a1 = document.createElement('button'); a1.textContent='Очень'; a1.onclick = ()=>nextQ(id);
    const a2 = document.createElement('button'); a2.textContent='Да'; a2.onclick = ()=>nextQ(id);
    answers.appendChild(a1); answers.appendChild(a2);
    card.appendChild(answers);
    questionsWrap.appendChild(card);
  });
  // last step: show final trigger
  const last = document.createElement('div'); last.className='card question'; last.id='q-final';
  const p = document.createElement('p'); p.textContent='Готова к самому важному шагу?'; last.appendChild(p);
  const b = document.createElement('div'); b.className='answers';
  const go = document.createElement('button'); go.textContent='Готова'; go.onclick = showFinal;
  b.appendChild(go); last.appendChild(b);
  questionsWrap.appendChild(last);
}

function nextQ(curr){
  const currEl = document.getElementById(curr);
  currEl.style.display='none';
  const next = curr.replace('q','q');
  // show next sibling
  const all = Array.from(document.querySelectorAll('.question'));
  const idx = all.findIndex(x=>x.id===curr);
  if(idx>=0 && idx<all.length-1){ all[idx+1].style.display='block'; }
}

// Typing effect
function typeText(el, text, speed=35, cb){
  el.textContent='';
  let i=0; const t = setInterval(()=>{ el.textContent += text[i++]||''; if(i>text.length){ clearInterval(t); if(cb) cb(); } }, speed);
}

// slideshow
let slideI=0; function slideLoop(){
  const slides = document.querySelectorAll('.slide');
  slides.forEach((s,idx)=> s.classList.toggle('active', idx===slideI));
  slideI = (slideI+1) % slides.length;
}
setInterval(slideLoop,3500);

// Start
startBtn.addEventListener('click', ()=>{
  // play music with gesture
  bgmusic.play().catch(()=>{});
  navigator.vibrate && navigator.vibrate(50);
  document.getElementById('start-card').style.display='none';
  testArea.style.display='block';
  // reveal first question
  buildQuestions();
  const first = document.querySelectorAll('.question')[0]; if(first) first.style.display='block';
  typeText(typedIntro, 'Для Лены — маленькое путешествие. Ты готова?');
});

// Final sequence
function showFinal(){
  document.querySelectorAll('.question').forEach(q=>q.style.display='none');
  // show slideshow of photos inside final
  finalPhotos.innerHTML = '
    <div style="border-radius:12px;overflow:hidden;height:200px">
      <img src="photo1.jpg" style="width:100%;height:100%;object-fit:cover">
    </div>';
  finalIntro.textContent = 'Если все ответы — это следы твоего сердца, то я хочу сделать следующий шаг.';
  finalScreen.style.display='block';
  // typing final text then fireworks and vibration
  const finalMsg = 'Лена... Ты — моё сердце. Моя будущая семья. Моя навсегда. 
Выйдешь за меня?';
  typeText(typedFinal, '', 25, ()=>{});
  // typed reveal with timing
  let idx=0; const tI = setInterval(()=>{
    typedFinal.textContent += finalMsg[idx++]||'';
    if(idx>finalMsg.length){ clearInterval(tI); setTimeout(()=>{ triggerFireworks(); navigator.vibrate && navigator.vibrate([100,50,100]); }, 600); }
  },30);
  // show animated hearts
  startHearts();
  // pause bgmusic then gently raise volume
  try{ bgmusic.volume = 0.85; }catch(e){}
}

// heart particles
let heartTimer=null; function startHearts(){ if(heartTimer) return; heartTimer=setInterval(()=>{ const el = document.createElement('div'); el.className='heart'; el.textContent='❤'; el.style.left = Math.random()*90 + 'vw'; el.style.bottom='-20px'; el.style.opacity=1; el.style.fontSize = (14 + Math.random()*20) + 'px'; el.style.transition = 'transform 6s linear, opacity 6s linear'; document.body.appendChild(el); requestAnimationFrame(()=>{ el.style.transform = 'translateY(-120vh) scale(1.8)'; el.style.opacity=0; }); setTimeout(()=>el.remove(),6500); },160); }

// Simple fireworks implementation
const canvas = document.getElementById('fire'); const ctx = canvas.getContext('2d'); let W, H; function resize(){ W = canvas.width = innerWidth; H = canvas.height = innerHeight; } resize(); addEventListener('resize', resize);
let particles = [];
function Firework(x,y){ this.x = x; this.y = y; this.color = 'hsl('+Math.floor(Math.random()*360)+',80%,60%)'; this.particles = []; for(let i=0;i<40;i++){ this.particles.push({x:this.x,y:this.y,vx:(Math.random()-0.5)*6,vy:(Math.random()-0.5)*6,life:Math.random()*60+30,age:0,alpha:1}); } }
function explode(x,y){ particles.push(new Firework(x,y)); }
function updateFire(){ ctx.clearRect(0,0,W,H); particles.forEach((f,fi)=>{ f.particles.forEach(p=>{ p.x += p.vx; p.y += p.vy; p.vy += 0.06; p.age++; p.alpha = Math.max(0,1 - p.age/p.life); ctx.globalAlpha = p.alpha; ctx.fillStyle = f.color; ctx.fillRect(p.x,p.y,2,2); }); // remove when all dead
    // remove firework when particles faded
    if(f.particles.every(p=>p.alpha<=0)){ particles.splice(fi,1); }
  }); requestAnimationFrame(updateFire);
}
updateFire();

function triggerFireworks(){ const count=6; for(let i=0;i<count;i++){ setTimeout(()=> explode(50 + Math.random()*(W-100), 100 + Math.random()* (H/2)), i*300); } }

// yes button
yesBtn.addEventListener('click', ()=>{
  // this is where you'd actually present the ring live — but for site, show final confetti and message
  alert('Я тебя люблю! ❤️');
});

// Accessibility: ensure images exist
// Note to user: place your photos in same folder named photo1.jpg, photo2.jpg, photo3.jpg

</script><audio id="bgMusic" src="https://cdn.pixabay.com/download/audio/2022/03/15/audio_7e3e04666b.mp3?filename=perfect-beauty-140470.mp3"></audio>

</body>
</html>